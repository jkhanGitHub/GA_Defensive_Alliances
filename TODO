TODO
rewrite so that one can use the single threaded methods instead of the multithreaded methods