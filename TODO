TODO
fix intersection_probability (optional since it sucks anyway)